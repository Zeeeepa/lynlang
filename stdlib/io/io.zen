// Zen Standard Library: IO Module
// Input/Output operations using compiler intrinsics

{ Result } = @std.core.result
{ compiler } = @std

// =============================================================================
// PRINT FUNCTIONS (stdout)
// =============================================================================

// Print a String to stdout (no newline)
print = (message: String) void {
    compiler.libc_write(1, message.data, message.len)
}

// Print a String to stdout with newline
println = (message: String) void {
    compiler.libc_write(1, message.data, message.len)
    // Write newline using syscall
    @builtin.syscall3(1, 1, compiler.ptr_to_int("\n"), 1)
}

// =============================================================================
// ERROR PRINT FUNCTIONS (stderr)
// =============================================================================

// Print a String to stderr (no newline)
eprint = (message: String) void {
    compiler.libc_write(2, message.data, message.len)
}

// Print a String to stderr with newline
eprintln = (message: String) void {
    compiler.libc_write(2, message.data, message.len)
    @builtin.syscall3(1, 2, compiler.ptr_to_int("\n"), 1)
}

// =============================================================================
// LOW-LEVEL IO (syscall-based, no libc dependency)
// =============================================================================

// Write using raw syscall (Linux x86-64 only, no libc)
// Use this when you need to avoid libc entirely
sys_write = (msg: StaticString, len: i64) i64 {
    msg_ptr = compiler.ptr_to_int(msg)
    return @builtin.syscall3(1, 1, msg_ptr, len)
}

// Write to stderr using raw syscall
sys_ewrite = (msg: StaticString, len: i64) i64 {
    msg_ptr = compiler.ptr_to_int(msg)
    return @builtin.syscall3(1, 2, msg_ptr, len)
}

// Raw syscall write to any file descriptor
sys_write_raw = (fd: i64, buf: RawPtr<u8>, count: i64) i64 {
    buf_addr = compiler.ptr_to_int(buf)
    return @builtin.syscall3(1, fd, buf_addr, count)
}

// =============================================================================
// INPUT FUNCTIONS (not yet implemented)
// =============================================================================

// Read line from stdin (not yet implemented)
read_line = () Result<String, String> {
    return Result.Err("Not implemented")
}

// Read with prompt (not yet implemented)
read_input = (prompt: String) Result<String, String> {
    return Result.Err("Not implemented")
}
