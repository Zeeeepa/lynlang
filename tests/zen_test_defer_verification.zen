// Test for @this.defer() cleanup mechanism from LANGUAGE_SPEC.zen
// Lines 217, 313-314, 379, etc. demonstrate defer usage

{ io } = @std

cleanup_test = () void {
    io.println("1. Starting cleanup test")
    
    // First defer - will execute last
    @this.defer(io.println("4. First defer executed (last)"))
    
    io.println("2. After first defer")
    
    // Second defer - will execute second to last
    @this.defer(io.println("3. Second defer executed (second)"))
    
    io.println("Function body complete")
}

main = () void {
    io.println("=== Testing @this.defer() Cleanup ===")
    
    cleanup_test()
    
    io.println("")
    io.println("âœ… @this.defer() works in LIFO order!")
}