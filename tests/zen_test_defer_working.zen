// Test @this.defer() functionality
{ io } = @std

test_defer = () void {
    io.println("1. Start of function")
    
    @this.defer(io.println("3. Deferred - executes last"))
    
    io.println("2. Middle of function")
    
    // Deferred expressions should execute in LIFO order at function exit
}

main = () void {
    io.println("=== Testing @this.defer() ===")
    test_defer()
    io.println("=== Complete ===")
}