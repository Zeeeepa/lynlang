// Test @this.defer
io = @std.io

test_defer = () void {
    io.println("Start")
    @this.defer(io.println("Deferred 1"))
    @this.defer(io.println("Deferred 2"))
    io.println("Middle")
    @this.defer(io.println("Deferred 3"))
    io.println("End")
    // Should print: Start, Middle, End, Deferred 3, Deferred 2, Deferred 1
}

main = () void {
    test_defer()
}