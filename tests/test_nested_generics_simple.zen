// Simple test for nested generics
{io, Option, Result} = @std

main = () i32 {
    // Test Option<Option<i32>>
    double_opt = Option.Some(Option.Some(42))
    
    double_opt ?
        | Some(inner) {
            inner ?
                | Some(v) { io.print_int(v) }  // Should print 42
                | None { io.println("Inner None") }
        }
        | None { io.println("Outer None") }
    
    io.println("")
    
    // Test Result<Option<i32>, String>
    res = Result.Ok(Option.Some(100))
    
    res ?
        | Ok(opt) {
            opt ?
                | Some(v) { io.print_int(v) }  // Should print 100
                | None { io.println("None value") }
        }
        | Err(e) { io.println(e) }
    
    io.println("")
    
    // Test Option<Result<i32, String>>
    opt_res = Option.Some(Result.Ok(200))
    
    opt_res ?
        | Some(r) {
            r ?
                | Ok(v) { io.print_int(v) }  // Should print 200
                | Err(e) { io.println(e) }
        }
        | None { io.println("No result") }
    
    io.println("")
    
    // Test triple nesting: Result<Option<Result<i32, String>>, String>
    triple = Result.Ok(Option.Some(Result.Ok(300)))
    
    triple ?
        | Ok(opt) {
            opt ?
                | Some(inner_res) {
                    inner_res ?
                        | Ok(v) { io.print_int(v) }  // Should print 300
                        | Err(e) { io.println(e) }
                }
                | None { io.println("Middle None") }
        }
        | Err(e) { io.println(e) }
    
    return 0
}