// Zen Test Runner
// Simple test program to verify the compiler works

io := @std.io
core := @std.core
math := @std.math

// Test basic arithmetic
test_arithmetic = () bool {
    a := 10
    b := 20
    c := a + b
    
    c == 30 ?
        | true => {
            io.println("PASS: arithmetic test")
            return true
        }
        | false => {
            io.println("FAIL: arithmetic test - expected 30, got something else")
            return false
        }
}

// Test function calls
fibonacci = (n: i32) i32 {
    n <= 1 ?
        | true => n
        | false => fibonacci(n - 1) + fibonacci(n - 2)
}

test_fibonacci = () bool {
    result := fibonacci(10)
    expected := 55
    
    result == expected ?
        | true => {
            io.println("PASS: fibonacci test")
            return true
        }
        | false => {
            io.println("FAIL: fibonacci test")
            return false
        }
}

// Test structs
Point = {
    x: i32,
    y: i32,
}

test_structs = () bool {
    p := Point { x: 10, y: 20 }
    
    (p.x == 10 && p.y == 20) ?
        | true => {
            io.println("PASS: struct test")
            return true
        }
        | false => {
            io.println("FAIL: struct test")
            return false
        }
}

// Test arrays
test_arrays = () bool {
    arr := [1, 2, 3, 4, 5]
    sum := 0
    i := 0
    
    loop i < 5 {
        sum = sum + arr[i]
        i = i + 1
    }
    
    sum == 15 ?
        | true => {
            io.println("PASS: array test")
            return true
        }
        | false => {
            io.println("FAIL: array test")
            return false
        }
}

// Test string operations
test_strings = () bool {
    str1 := "Hello"
    str2 := "World"
    combined := str1 + ", " + str2 + "!"
    
    // Just test that we can create and combine strings
    io.println("PASS: string test")
    return true
}

// Main test runner
main = () i32 {
    io.println("=== Running Zen Tests ===")
    io.println("")
    
    passed := 0
    failed := 0
    
    // Run all tests - simpler approach
    test_arithmetic() ? | true => { passed = passed + 1 } | false => { failed = failed + 1 }
    test_fibonacci() ? | true => { passed = passed + 1 } | false => { failed = failed + 1 }
    test_structs() ? | true => { passed = passed + 1 } | false => { failed = failed + 1 }
    test_arrays() ? | true => { passed = passed + 1 } | false => { failed = failed + 1 }
    test_strings() ? | true => { passed = passed + 1 } | false => { failed = failed + 1 }
    
    io.println("")
    io.println("=== Test Results ===")
    io.print("Passed: ")
    io.print_int(passed)
    io.print(" Failed: ")
    io.print_int(failed)
    io.println("")
    
    failed > 0 ?
        | true => 1
        | false => 0
}