// main.zen - Comprehensive demonstration of Zen language features
// This example showcases practical features of the Zen programming language

{ io } = @std

// ============================================================================
// 1. STRUCTS - Custom data types with fields
// ============================================================================

Person: {
    name: StaticString,
    age: i32,
}

Point: {
    x: f64,
    y: f64
}

// ============================================================================
// 2. ENUMS - Sum types with variants
// ============================================================================

Status:
    Active,
    Inactive,
    Banned

Color:
    Red,
    Green,
    Blue

// ============================================================================
// 3. FUNCTIONS - Various function patterns
// ============================================================================

// Simple function
add = (a: i32, b: i32) i32 {
    return a + b
}

multiply = (a: i32, b: i32) i32 {
    return a * b
}

divide = (a: f64, b: f64) i32 {
    b == 0.0 ?
        | true { return -1 }
        | false { return (a / b) as i32 }
}

greet = (name: StaticString) void {
    io.println("Hello, ${name}!")
}

// ============================================================================
// 4. PATTERN MATCHING - Exhaustive matching
// ============================================================================

describe_status = (status: Status) StaticString {
    status ?
        | Active { "User is active" }
        | Inactive { "User is inactive" }
        | Banned { "User is banned" }
}

describe_color = (color: Color) StaticString {
    color ?
        | Red { "Primary color: Red" }
        | Green { "Primary color: Green" }
        | Blue { "Primary color: Blue" }
}

// ============================================================================
// 5. UNIVERSAL FUNCTION CALL (UFC) - Method chaining
// ============================================================================

double = (x: i32) i32 { 
    return x * 2 
}

add_ten = (x: i32) i32 { 
    return x + 10 
}

square = (x: i32) i32 { 
    return x * x 
}

// ============================================================================
// 6. LOOPS AND ITERATION
// ============================================================================

demo_loops = () void {
    io.println("")
    io.println("=== LOOPS ===")
    
    // Simple counter loop
    io.println("Counter loop (0-4):")
    i := 0
    loop(() {
        i >= 5 ? { break }
        io.print("${i} ")
        i = i + 1
    })
    io.println("")
}

// ============================================================================
// 7. BLOCK EXPRESSIONS
// ============================================================================

compute_greeting = (hour: i32) StaticString {
    greeting := ""
    hour < 12 ?
        | true { greeting = "Good morning" }
        | false {
            hour < 18 ?
                | true { greeting = "Good afternoon" }
                | false { greeting = "Good evening" }
        }
    return greeting
}

// ============================================================================
// MAIN FUNCTION - Entry point demonstrating all features
// ============================================================================

main = () i32 {
    io.println("=== ZEN LANGUAGE FEATURE SHOWCASE ===")
    io.println("Demonstrating practical Zen features\n")
    
    // Basic arithmetic
    io.println("1. Basic arithmetic:")
    io.println("   10 + 5 = ${add(10, 5)}")
    io.println("   10 * 5 = ${multiply(10, 5)}")
    io.println("   10 / 2 = ${divide(10.0, 2.0)}")
    
    // Pattern matching with enums
    io.println("")
    io.println("2. Pattern matching:")
    status = Status.Active
    io.println("   Status: ${describe_status(status)}")
    
    color = Color.Red
    io.println("   Color: ${describe_color(color)}")
    
    // Struct usage
    io.println("")
    io.println("3. Struct usage:")
    person = Person {
        name: "Alice",
        age: 30
    }
    io.println("   Person: ${person.name}, age ${person.age}")
    
    // UFC (Universal Function Call)
    io.println("")
    io.println("4. UFC (Method Chaining):")
    result = 5.double().add_ten().double()
    io.println("   5.double().add_ten().double() = ${result}")
    
    computed = 3.square().double().add_ten()
    io.println("   3.square().double().add_ten() = ${computed}")
    
    // Block expressions
    io.println("")
    io.println("5. Block expressions:")
    greeting = compute_greeting(14)
    io.println("   At 14:00 - ${greeting}")
    
    morning_greeting = compute_greeting(9)
    io.println("   At 09:00 - ${morning_greeting}")
    
    // Loops
    demo_loops()
    
    // String interpolation
    io.println("")
    io.println("6. String interpolation:")
    name = "Zen"
    version = 1
    io.println("   Welcome to ${name} v${version}!")
    
    io.println("")
    io.println("=== DEMONSTRATION COMPLETE ===")
    io.println("Zen: Where elegance meets efficiency")
    
    return 0
}
